---
import TaxaLayout from "@components/blog/TaxaLayout.astro";
import { getCollection } from "astro:content";
import { slugify } from "@lib/textConverter";

const taxonomy = "tags";
const title = "标签";

// 从content collections获取所有已发布的博客文章
const allPosts = await getCollection("blog", ({ data }) => {
  return data.status === "published" && !data.draft;
});

// 提取所有标签
let allTaxa: string[] = [];
allPosts.forEach(post => {
  if (post.data.tags && Array.isArray(post.data.tags)) {
    post.data.tags.forEach(tag => {
      allTaxa.push(slugify(tag));
    });
  }
});

// 获取唯一标签列表并排序
const taxa = [...new Set(allTaxa)].sort((a, b) => a.localeCompare(b));
---

<TaxaLayout taxonomy={taxonomy} taxonomyTitle={title} taxa={taxa} allTaxa={allTaxa} />  
