---
import type { FriendLink } from "@/types/friendLinks";

interface Props {
  link: FriendLink;
}

const { link }: Props = Astro.props;
const { name, url, description, avatar, status = "active" } = link;
---

<div
  class="friend-card glass h-full rounded-[18px] overflow-hidden transition-all duration-300 group hover:scale-[1.02] hover:shadow-xl backdrop-blur-md"
>
  <a
    href={url}
    target="_blank"
    rel="external nofollow noopener noreferrer"
    class="block h-full p-4 no-underline"
  >
    <div class="flex items-center space-x-3 h-full">
      <!-- 头像 -->
      <div class="flex items-center relative">
        <div
          class="friend-avatar relative w-16 h-16 rounded-full overflow-hidden ring-2 ring-primary/20 group-hover:ring-primary/40 transition-all duration-300"
        >
          <img
            src={avatar}
            alt={`${name} 的头像`}
            class="w-full h-full object-cover transition-transform duration-300 group-hover:scale-110"
            loading="lazy"
            onerror="this.src='/favicon/logo-192x192.png'"
          />
        </div>
        <!-- 状态指示器 -->
        {
          status === "active" && (
            <div
              class="status-indicator absolute top-5 right-2 w-4 h-4 bg-green-500 rounded-full border-2 border-white dark:border-gray-800 z-10"
              title="正常状态"
            />
          )
        }
      </div>

      <!-- 内容区域 -->
      <div class="flex-1 min-w-0">
        <!-- 网站名称 -->
        <h3
          class="friend-name text-lg font-bold text-txt-p dark:text-darkmode-txt-p mb-1 truncate group-hover:text-primary transition-colors duration-200"
        >
          {name}
        </h3>

        <!-- 网站描述 -->
        <p
          class="friend-description text-sm text-txt-light dark:text-darkmode-txt-light line-clamp-2 leading-relaxed"
        >
          {description}
        </p>
      </div>
    </div>

    <!-- 悬浮效果 -->
    <div
      class="absolute inset-0 bg-gradient-to-r from-primary/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300 rounded-[18px]"
    >
    </div>
  </a>
</div>

<style>
  .line-clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  .friend-card {
    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    /* backdrop-filter: blur(12px); */
    border: 1px solid rgba(255, 255, 255, 0.1);
    position: relative;
    overflow: hidden;
  }

  .friend-card::before {
    content: "";
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(
      90deg,
      transparent,
      rgba(255, 255, 255, 0.1),
      transparent
    );
    transition: left 0.4s ease;
  }

  .friend-card:hover::before {
    left: 100%;
  }

  .friend-card:hover {
    transform: translateY(-8px) scale(1.02);
    box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
    border-color: rgba(255, 255, 255, 0.2);
  }

  .friend-avatar {
    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    position: relative;
  }

  .friend-avatar::after {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    border-radius: 50%;
    background: linear-gradient(
      45deg,
      transparent,
      rgba(255, 255, 255, 0.2),
      transparent
    );
    opacity: 0;
    transition: opacity 0.4s ease;
  }

  .friend-card:hover .friend-avatar {
    transform: scale(1.15) rotate(5deg);
  }

  .friend-card:hover .friend-avatar::after {
    opacity: 1;
  }

  .friend-name {
    transition: color 0.4s ease;
  }

  .friend-card:hover .friend-name {
    background: linear-gradient(45deg, #667eea, #764ba2);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
  }

  .friend-description {
    transition: transform 0.4s ease;
  }

  .friend-card:hover .friend-description {
    transform: translateY(-2px);
  }

  .friend-url {
    transition: all 0.4s ease;
    position: relative;
    overflow: hidden;
  }

  .friend-url::before {
    content: "";
    position: absolute;
    bottom: 0;
    left: 0;
    width: 0;
    height: 1px;
    background: linear-gradient(90deg, #667eea, #764ba2);
    transition: width 0.4s ease;
  }

  .friend-card:hover .friend-url::before {
    width: 100%;
  }

  .status-indicator {
    animation: pulse 1s infinite;
    position: relative;
  }

  .status-indicator::after {
    content: "";
    position: absolute;
    top: 50%;
    left: 50%;
    width: 100%;
    height: 100%;
    border-radius: 50%;
    background: inherit;
    transform: translate(-50%, -50%);
    animation: ripple 1s infinite;
    opacity: 0.3;
  }

  @keyframes pulse {
    0%,
    100% {
      opacity: 1;
      transform: scale(1);
    }
    50% {
      opacity: 0.7;
      transform: scale(1.1);
    }
  }

  @keyframes ripple {
    0% {
      transform: translate(-50%, -50%) scale(1);
      opacity: 0.3;
    }
    100% {
      transform: translate(-50%, -50%) scale(2);
      opacity: 0;
    }
  }

  /* 响应式优化 */
  @media (max-width: 768px) {
    .friend-card:hover {
      transform: translateY(-4px) scale(1.01);
    }

    .friend-card:hover .friend-avatar {
      transform: scale(1.1) rotate(3deg);
    }
  }
</style>
